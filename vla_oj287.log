REFANTS: VA09, VA23, VA27. Also 7, 21, 25 respectively
Flux calib  -> FieldID:2 and Name: 0538+498
Phase calib -> FieldID:5 and Name: 1225+368
Target      -> FieldID:4 and Name: 0851+202

importvla
listobs
plotants
flagdata(vis='oj287.ms/', mode='shadow', tolerance=0.0, flagbackup=False)
flagdata(vis='oj287.ms/', mode='clip', clipzeros=True, flagbackup=False)
flagdata(vis='oj287.ms/', mode='quack', quackinterval=5.0, quackmode='beg', flagbackup=False)

plotms and flags
gencal( vis='oj287.MS',caltable='antpos_sol',caltype='antpos',infile='',endpoint='asdm',uniform=True)

2) SETJY
setjy(vis='oj287.ms/', field='0538+498', standard='Perley-Butler 2013', model='3C147_L.im', usescratch=False, scalebychan=True, spw='0,1')

3) PHASE
gaincal(vis='oj287.ms/', caltable='oj287.G0all', field='2,5', refant='7', spw='0,1', gaintype='G', calmode='p', solint='int', minsnr=5.0,)

4) GAIN
gaincal(vis='oj287.ms/',caltable='oj287.G1', 
field='0538+498',spw='0,1', 
solint='inf',refant='7', gaintype='G',calmode='ap', solnorm=False, 
gaintable=['oj287.G0all/'], 
interp=['',])  

gaincal(vis='oj287.ms/',caltable='oj287.G1', 
field='1225+368',spw='0,1', 
solint='inf',refant='7',gaintype='G',calmode='ap',solnorm=False, 
gaintable=['oj287.G0all/'], 
interp=['',], append=True) 

5) SCALING THE AMPLITUDE GAINS

myscale = fluxscale(vis='oj287.ms/', 
caltable='oj287.G1/',  
fluxtable='oj287.fluxscale1',  
reference='0538+498', 
transfer=['1225+368'], 
incremental=False) 

6) APPLYCAL

applycal(vis='oj287.ms/', 
field='0538+498', 
gaintable=['oj287.fluxscale1', 
            'oj287.G0all/'], 
gainfield=['','0538+498','',''],  
interp=['nearest',''], 
calwt=False) 


applycal(vis='oj287.ms/', 
field='1225+368', 
gaintable=['oj287.fluxscale1', 
           'oj287.G0all/'], 
gainfield=['','1225+368','',''],  
interp=['nearest',''], 
calwt=False)  


applycal(vis='oj287.ms/', 
field='0851+202', 
gaintable=['oj287.fluxscale1', 
           'oj287.G0all/'], 
gainfield=['','1225+368','',''],  
interp=['linear',''], 
calwt=False)   


7) Inspection Plots
plotms(vis='oj287.ms',field='2',correlation='RR,LL',
       antenna='',avgtime='60',xaxis='channel',yaxis='amp',
       ydatacolumn='corrected',coloraxis='corr',
       plotfile='plotms_oj287-fld2-corrected-amp.png')

plotms(vis='oj287.ms',field='2',correlation='RR,LL',
       antenna='',avgtime='60',xaxis='channel',yaxis='phase',
       ydatacolumn='corrected',coloraxis='corr',
       plotrange=[-1,-1,-180,180],
       plotfile='plotms_oj287-fld2-corrected-phase.png')

plotms(vis='oj287.ms',field='5',correlation='RR,LL',
       antenna='',avgtime='60',xaxis='channel',yaxis='amp',
       ydatacolumn='corrected',coloraxis='corr',
       plotfile='plotms_oj287-fld5-corrected-amp.png')

plotms(vis='oj287.ms',field='5',correlation='RR,LL',
       antenna='',avgtime='60',xaxis='channel',yaxis='phase',
       ydatacolumn='corrected',coloraxis='corr',
       plotrange=[-1,-1,-180,180],
       plotfile='plotms_oj287-fld5-corrected-phase.png')


8) 
split(vis='oj287.ms',outputvis='oj287_calibrated_spw0.ms', datacolumn='corrected',field='0851+202',correlation='RR,LL',spw='0')
split(vis='oj287.ms',outputvis='oj287_calibrated_spw1.ms', datacolumn='corrected',field='0851+202',correlation='RR,LL',spw='1')

9) Imaging
plotms(vis='oj287_calibrated_spw0.ms',xaxis='uvwave',yaxis='amp',
       ydatacolumn='data', field='0',avgtime='30',correlation='RR',
       plotfile='plotms_oj287-uvwave.png',overwrite=True)

tclean(vis='oj287_calibrated_spw0.ms',imagename='oj287_multiscale_spw0',
      field='',spw='',
      specmode='mfs',
      niter=20000,
      gain=0.1, threshold='1.0mJy',
      gridder='standard',
      deconvolver='multiscale',
      scales=[0, 5, 15, 45], smallscalebias=0.9,
      interactive=True,
      imsize=[1024,1024], cell=['0.075arcsec','0.075arcsec'],
      stokes='I',
      weighting='briggs',robust=0.0,
      pbcor=False,
      savemodel='modelcolumn')



10) Self Calibration:
delmod('oj287_calibrated_spw0.ms')

tclean(vis='oj287_calibrated_spw0.ms',imagename='oj287_calibrated_spw0_I',
      field='',spw='',
      specmode='mfs',
      niter=20000,
      gain=0.1,threshold='1mJy',
      gridder='standard',
      deconvolver='multiscale',
      scales=[0, 5, 15, 45],smallscalebias=0.9,
      interactive=True,
      imsize=[1024,1024],cell=['0.075arcsec','0.075arcsec'],
      stokes='I',
      weighting='briggs',robust=0.0,
      pbcor=False,
      savemodel='modelcolumn')


gaincal(vis='oj287_calibrated_spw0.ms',caltable='oj287_calibrated_spw0.selfcal1',
        field='',spw='',selectdata=False,
        solint='30s',refant='7',minblperant=4,minsnr=3,
        gaintype='G',calmode='p')

applycal(vis='oj287_calibrated_spw0.ms',
         field='',spw='',selectdata=False,
         gaintable= ['oj287_calibrated_spw0.selfcal1'],gainfield=[''],interp=['nearest'],
         calwt=[False],applymode='calflag')


tclean(vis='oj287_calibrated_spw0.ms',imagename='oj287_calibrated_spw0_multiscale_selfcal1',
      field='',spw='',
      specmode='mfs',
      niter=20000,
      gain=0.1,threshold='1mJy',
      gridder='standard',
      deconvolver='multiscale',
      scales=[0, 5, 15, 45],smallscalebias=0.9,
      interactive=True,
      imsize=[1024,1024],cell=['0.075arcsec','0.075arcsec'],
      stokes='I',
      weighting='briggs',robust=0.0,
      pbcor=False,
      savemodel='modelcolumn')

------------- Round 2 ---------------
gaincal(vis='oj287_calibrated_spw0.ms',caltable='oj287_calibrated_spw0.selfcal2',
        field='',spw='',selectdata=False,
        solint='100s',refant='7',minblperant=4,minsnr=3,
        gaintype='G',calmode='p')

applycal(vis='oj287_calibrated_spw0.ms',
         field='',spw='',selectdata=False,
         gaintable= ['oj287_calibrated_spw0.selfcal2'],gainfield=[''],interp=['nearest'],
         calwt=[False],applymode='calflag')

tclean(vis='oj287_calibrated_spw0.ms',imagename='oj287_calibrated_spw0_multiscale_selfcal2',
      field='',spw='',
      specmode='mfs',
      niter=20000,
      gain=0.1,threshold='1mJy',
      gridder='standard',
      deconvolver='multiscale',
      scales=[0, 5, 15, 45],smallscalebias=0.9,
      interactive=True,
      imsize=[1024,1024],cell=['0.075arcsec','0.075arcsec'],
      stokes='I',
      weighting='briggs',robust=0.0,
      pbcor=False,
      savemodel='modelcolumn')

------------- Round 3 ---------------
gaincal(vis='oj287_calibrated_spw0.ms',caltable='oj287_calibrated_spw0.selfcal3',
        field='',spw='',selectdata=False,
        solint='30s',refant='7',minblperant=4,minsnr=3,
        gaintype='G',calmode='ap')

applycal(vis='oj287_calibrated_spw0.ms',
         field='',spw='',selectdata=False,
         gaintable= ['oj287_calibrated_spw0.selfcal3'],gainfield=[''],interp=['nearest'],
         calwt=[False],applymode='calflag')

tclean(vis='oj287_calibrated_spw0.ms',imagename='oj287_calibrated_spw0_multiscale_selfcal3',
      field='',spw='',
      specmode='mfs',
      niter=20000,
      gain=0.1,threshold='1mJy',
      gridder='standard',
      deconvolver='multiscale',
      scales=[0, 5, 15, 45],smallscalebias=0.9,
      interactive=True,
      imsize=[1024,1024],cell=['0.075arcsec','0.075arcsec'],
      stokes='I',
      weighting='briggs',robust=0.0,
      pbcor=False,
      savemodel='modelcolumn')


------ Round 4 --------
CASA <74>: gaincal(vis='oj287_calibrated_spw0.ms',caltable='oj287_calibrated_spw0.selfcal4',
      ...:         field='',spw='',selectdata=False,
      ...:         solint='100s',refant='7',minblperant=4,minsnr=3,
      ...:         gaintype='G',calmode='ap')

CASA <75>: applycal(vis='oj287_calibrated_spw0.ms',
      ...:          field='',spw='',selectdata=False,
      ...:          gaintable= ['oj287_calibrated_spw0.selfcal4'],gainfield=[''],interp=['nearest'],
      ...:          calwt=[False],applymode='calflag')

CASA <76>: tclean(vis='oj287_calibrated_spw0.ms',imagename='oj287_calibrated_spw0_multiscale_selfcal4',
      ...:       field='',spw='',
      ...:       specmode='mfs',
      ...:       niter=20000,
      ...:       gain=0.1,threshold='1mJy',
      ...:       gridder='standard',
      ...:       deconvolver='multiscale',
      ...:       scales=[0, 5, 15, 45],smallscalebias=0.9,
      ...:       interactive=True,
      ...:       imsize=[1024,1024],cell=['0.075arcsec','0.075arcsec'],
      ...:       stokes='I',
      ...:       weighting='briggs',robust=-0.5,
      ...:       pbcor=False,
      ...:       savemodel='modelcolumn')


------ Round 5 -------




